<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Member Area</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/member.css">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">CSEC ASTU</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#" id="homeLink">Home</a>
                </li>

                <li class="nav-item">
                    <a class="nav-link" href="#" id="eventsLink">Events</a>
                </li>

                <li class="nav-item dropdown ml-auto">
                    <a class="nav-link dropdown-toggle" href="#" id="profileDropdown" role="button"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        My Profile
                    </a>
                    <div class="dropdown-menu" aria-labelledby="profileDropdown">
                        <a class="dropdown-item" href="#" id="editProfileLink">Edit Profile</a>
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container mt-4" id="variablePage">
        <!-- Content will be dynamically loaded here based on menu selection -->
    </div>


    <!---Modal for edit password-->
    <div class="modal fade" id="editPasswordModal" tabindex="-1" role="dialog" aria-labelledby="editPasswordModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editPasswordModalLabel">Edit Password</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Form for changing password -->
                    <form id="editPasswordForm">
                        <div class="form-group">
                            <label for="oldPassword">Old Password</label>
                            <input type="password" class="form-control" id="oldPassword" name="oldPassword" required>
                        </div>
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <input type="password" class="form-control" id="newPassword" name="newPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Change Password</button>
                    </form>
                </div>
            </div>
        </div>
    </div>


    <!-- Bootstrap JS and Popper.js (required for Bootstrap JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <script>
        // Display the content for the selected menu
        function showContent(content) {
            document.getElementById("variablePage").innerHTML = content;
        }

        // Set the home page as the initial content
        showContent("<img src='assets/images/computer_science_and_engineering_club_cover.jpeg' alt='Welcome Image'><h2>Welcome to CSEC ASTU Club Management</h2>");

        // Event listeners for menu items
        document.getElementById("homeLink").addEventListener("click", function () {
            showContent("<img src='assets/images/computer_science_and_engineering_club_cover.jpeg' alt='Welcome Image'><h2>Welcome to CSEC ASTU Club Management</h2>");
        });

        //=========================Event Area=========================
        document.getElementById("eventsLink").addEventListener("click", function () {
            // Add your events content here
            showContent("<h2>Events</h2><p>Upcoming Events...</p>");
        });
        //=============================================================

        //==================Edit password area==================================
        // Add event listener for "Edit Profile" link
            document.getElementById("editProfileLink").addEventListener("click", function () {
                // Show the "Edit Password" modal
                $('#editPasswordModal').modal('show');
            });

           // Function to change the password
            function changePassword() {
                // Extract old password and new password from the form
                const oldPassword = document.getElementById("oldPassword").value;
                const newPassword = document.getElementById("newPassword").value;

                // Call the function to make the HTTP POST request
                changePasswordRequest(oldPassword, newPassword);
            }

            // Function to make the HTTP POST request
            function changePasswordRequest(oldPassword, newPassword) {
                // Create FormData object and append data
                const formData = new FormData();
                formData.append('oldPassword', oldPassword);
                formData.append('newPassword', newPassword);

                // Make the HTTP POST request using fetch
                fetch('/change-password', {
                    method: 'POST',
                    body: formData,
                })
                    .then(response => response.text())
                    .then(data => {
                        // Handle the response, e.g., show a success message
                        console.log(data);
                        // Optionally, you can close the modal
                        $('#editPasswordModal').modal('hide');
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        // Handle the error, e.g., show an error message
                    });
            }

        //=============================================================
    </script>
</body>

</html>